{
  "$schema": "https://vega.github.io/schema/vega-lite/v5.json",
  "title": {
    "text": "Household Income and Education Completion Trends (2016-2022)",
    "fontSize": 20,
    "fontWeight": "bold",
    "anchor": "start",
    "offset": 20,
    "dx": 37
  },
  "width": 900,
  "height": 500,
  "data": {
    "url": "https://raw.githubusercontent.com/GurgobindSingh/FIT3179_Assignment2/main/line_chart_household_income_education.csv"
  },
  "transform": [
    {
      "calculate": "datum.variable === 'Median Household Income (RM)' ? 'Income' : datum.variable === 'Primary Completion (%)' ? 'Primary' : datum.variable === 'Lower Secondary Completion (%)' ? 'Lower Secondary' : 'Upper Secondary'",
      "as": "category"
    },
    {
      "calculate": "datum.variable === 'Median Household Income (RM)' ? 'Household Income' : 'Education Completion'",
      "as": "measure_type"
    }
  ],
  "encoding": {
    "x": {
      "field": "year ",
      "type": "temporal",
      "timeUnit": "year",
      "axis": {
        "title": "Year",
        "format": "%Y",
        "labelAngle": 0
      }
    }
  },
  "layer": [
    {
      "transform": [{"filter": "datum.measure_type === 'Education Completion'"}],
      "mark": {"type": "line", "point": true, "strokeWidth": 2},
      "encoding": {
        "y": {
          "field": "value",
          "type": "quantitative",
          "axis": {"title": "Completion Rate (%)", "titleColor": "#000000"},
          "scale": {"domain": [90, 100]}
        },
        "color": {
          "field": "category",
          "type": "nominal",
          "scale": {
            "domain": ["Primary", "Lower Secondary", "Upper Secondary", "Income"],
            "range": ["#0072B2", "#E69F00", "#56B4E9", "#000000"]
          },
          "legend": {
            "title": ["Education & Income Categories"],
            "titleFontSize": 16,
            "labelFontSize": 13,
            "symbolSize": 300,
            "orient": "top",
            "direction": "horizontal",
            "offset": 10,
            "titleLimit": 400,
            "labelLimit": 150,
            "columnPadding": 20,
            "symbolOffset": 10,
            "titlePadding": 15,
            "titleAnchor": "start"
          }
        },
        "tooltip": [
          {"field": "year ", "type": "temporal", "timeUnit": "year", "title": "Year", "format": "%Y"},
          {"field": "category", "type": "nominal", "title": "Level"},
          {"field": "value", "type": "quantitative", "title": "Completion Rate (%)", "format": ".2f"}
        ]
      }
    },
    {
      "transform": [{"filter": "datum.measure_type === 'Household Income'"}],
      "mark": {
        "type": "line",
        "point": {"filled": true, "size": 100},
        "strokeWidth": 3,
        "strokeDash": [5, 5]
      },
      "encoding": {
        "y": {
          "field": "value",
          "type": "quantitative",
          "axis": {
            "title": "Median Household Income (RM)",
            "titleColor": "#000000",
            "orient": "right"
          },
          "scale": {"domain": [5000, 6500]}
        },
        "color": {
          "field": "category",
          "type": "nominal",
          "scale": {
            "domain": ["Primary", "Lower Secondary", "Upper Secondary", "Income"],
            "range": ["#0072B2", "#E69F00", "#56B4E9", "#000000"]
          },
          "legend": {
            "title": ["Education & Income Categories"],
            "titleFontSize": 16,
            "labelFontSize": 13,
            "symbolSize": 300,
            "orient": "top",
            "direction": "horizontal",
            "offset": 10,
            "titleLimit": 400,
            "labelLimit": 150,
            "columnPadding": 20,
            "symbolOffset": 10,
            "titlePadding": 15,
            "titleAnchor": "start"
          }
        },
        "tooltip": [
          {"field": "year ", "type": "temporal", "timeUnit": "year", "title": "Year", "format": "%Y"},
          {"field": "category", "type": "nominal", "title": "Category"},
          {"field": "value", "type": "quantitative", "title": "Median Income (RM)", "format": ",.2f"}
        ]
      }
    },
    {
      "data": {"values": [{"year ": "2019"}]},
      "mark": {"type": "rule", "color": "gray", "strokeWidth": 2, "strokeDash": [4, 4]}
    },
    {
      "data": {"values": [{"year ": "2019", "label": "Pre-Pandemic Peak"}]},
      "mark": {
        "type": "text",
        "align": "left",
        "dx": 5,
        "dy": -250,
        "fontSize": 10,
        "fontWeight": "bold",
        "color": "gray"
      },
      "encoding": {
        "text": {"field": "label"}
      }
    },
    {
      "data": {"values": [{"year ": "2020"}]},
      "mark": {"type": "rule", "color": "gray", "strokeWidth": 2, "strokeDash": [4, 4]}
    },
    {
      "data": {"values": [{"year ": "2020", "label": "COVID-19 Pandemic"}]},
      "mark": {
        "type": "text",
        "align": "left",
        "dx": 5,
        "dy": -250,
        "fontSize": 10,
        "fontWeight": "bold",
        "color": "gray"
      },
      "encoding": {
        "text": {"field": "label"}
      }
    },
    {
      "data": {"values": [{"year ": "2021"}]},
      "mark": {"type": "rule", "color": "gray", "strokeWidth": 2, "strokeDash": [4, 4]}
    },
    {
      "data": {"values": [{"year ": "2021", "label": "Post-Pandemic Recovery"}]},
      "mark": {
        "type": "text",
        "align": "left",
        "dx": 5,
        "dy": -250,
        "fontSize": 10,
        "fontWeight": "bold",
        "color": "gray"
      },
      "encoding": {
        "text": {"field": "label"}
      }
    }
  ],
  "resolve": {"scale": {"y": "independent"}},
  "config": {
    "view": {"stroke": "transparent"},
    "axis": {"grid": true, "gridOpacity": 0.3}
  }
}
